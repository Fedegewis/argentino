<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Buscador</title>
</head>
<body>
  <!-- Reutilizo tu mismo buscador -->
  <div id="tope2_buscar">
    <form id="form-buscar" method="get" action="/buscar.html" class="formulario">
      <input name="b" id="buscar_tope" type="text" maxlength="100" placeholder="¿qué buscas?">
      <button type="submit">
        <svg alt="search">
          <use xlink:href="imagenes/sprite.svg?3#search"></use>
        </svg>
      </button>
    </form>
  </div>

  <script>
    const paginas = [
      "aberturas","abogados","accesorios+para+baño","aceites+vegetales","adiestramiento+de+perros",
      "adopcion+de+mascotas","agencias+de+modelaje","agencias+de+publicidad","aislantes","albaniles",
      "alfombras","alimentos+congelados","alimentos+dieteticos","alimentos+en+conserva",
      "alimentos+para+mascotas","alimentos+veganos","ambulancias","andamios","anticuarios","arquitectos",
      "artes+marciales","articulos+de+electricidad","articulos+de+limpieza","articulos+de+peluqueria",
      "articulos+deportivos","atletismo","autos","autobuses","autoescuelas","autos+chocados","azucar",
      "ballet","balonmano","banos+portatiles","banos+quimicos","barberias","basquet","bazares",
      "bebidas+alcoholicas","bebidas+sin+alcohol","bibliotecas","bicicleterias","billares","bowling",
      "calefaccion+y+ventilacion","camiones","camionetas","carnavales","carnes","carpinteros+de+obra",
      "carros+de+golf","casas+rodantes","caza+y+pesca","centros+educativos","cereales","chocolate",
      "ciclismo","cines","circos","clases+de+idiomas","clubes+deportivos","colchoneria","colegios",
      "comics","concesionarios","conciertos","conejo+mascota","contadores","corseterias",
      "cortinas+y+persianas","cristalerias","cursos","desfiles+de+modas","discotecas",
      "disenadores+graficos","droguerias","educacion+artistica","educacion+especial",
      "educacion+primaria","educacion+privada","educacion+religiosa","educacion+secundaria",
      "electricistas","electrodomesticos","escribanos","escuelas","estetica+corporal","eventos",
      "florerias","gatos+mascota","higiene+personal","iluminacion","imprentas",
      "instrumentos+musicales","jardineria","joyerias","jugueterias","librerias","maquillajes",
      "marroquinerias","muebles","pajarerias","paseadores+de+perros","peceras","peces","peluquerias",
      "peluquerias+de+mascotas","piercings","tatuajes","unas","venta+de+inmuebles","veterinarias"
    ];

    function normalizeInput(q) {
      return (q || "").trim().toLowerCase();
    }

    function findPaginaForQuery(query) {
      const q = normalizeInput(query);
      if (!q) return null;
      const plusVariant = q.replace(/\s+/g, "+");
      for (const p of paginas) {
        const pSpace = p.replace(/\+/g, " ").toLowerCase();
        if (p === plusVariant) return p;
        if (pSpace === q) return p;
        if (pSpace.includes(q)) return p;
        if (p.includes(plusVariant)) return p;
      }
      return null;
    }

    async function handleSearch(query) {
      const pagina = findPaginaForQuery(query);
      if (pagina) {
        const base = "https://fedegewis.github.io/argentino/mexico/";
        const candidatos = [
          `${base}${pagina}`,
          `${base}${pagina}.html`
        ];
        for (const url of candidatos) {
          try {
            const resp = await fetch(url, { method: "HEAD" });
            if (resp.ok) {
              window.location.href = url;
              return;
            }
          } catch (err) {
            console.log("Error al probar:", url, err);
          }
        }
        alert("No se encontró la página para: " + pagina);
      } else {
        alert("No se encontraron resultados para: " + query);
      }
    }

    // Detectar ?b= en la URL y redirigir
    const urlParams = new URLSearchParams(window.location.search);
    const urlQuery = urlParams.get("b");
    if (urlQuery) {
      handleSearch(urlQuery);
    }
  </script>
</body>
</html>
